(function(){var t=[].slice;this.Chart=function(){"use strict";function e(t){if(this.selectors=t,!e.Util.is("String",this.selectors))throw new TypeError("This argument is not selectors string")}return e.Util=function(){function e(){}return e.extend=function(){var e,n,r,i,a,o,s;for(e=arguments[0],i=2<=arguments.length?t.call(arguments,1):[],o=0,s=i.length;s>o;o++){r=i[o];for(n in r)a=r[n],e[n]=a}return e},e.is=function(t,e){var n;return n=Object.prototype.toString.call(e).slice(8,-1),void 0!==e&&null!==e&&n===t},e}(),e.prototype.Bar=function(t,n){var r;return this.validateData(t),this.Bar.defaults={scaleOverlay:!1,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,animation:!0,animationSteps:60,animationEasing:"easeOutQuad",onAnimationComplete:null},r=this.mergeOptions(this.Bar.defaults,n),new e.D3Bar(this.selectors,t,r).render()},e.prototype.Doughnut=function(t,n){var r;return this.validateData(t),this.Doughnut.defaults={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animation:!0,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,onAnimationComplete:null},r=this.mergeOptions(this.Doughnut.defaults,n),new e.D3Doughnut(this.selectors,t,r).render()},e.prototype.Line=function(t,n){var r;return this.validateData(t),this.Line.defaults={scaleOverlay:!1,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,bezierCurve:!0,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:2,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,animation:!0,animationSteps:60,animationEasing:"easeOutQuad",onAnimationComplete:null},r=this.mergeOptions(this.Line.defaults,n),new e.D3Line(this.selectors,t,r).render()},e.prototype.Pie=function(t,n){var r;return this.validateData(t),this.Pie.defaults={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animation:!0,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,onAnimationComplete:null},r=this.mergeOptions(this.Pie.defaults,n),new e.D3Pie(this.selectors,t,r).render()},e.prototype.easingTypes={linear:"linear",easeInQuad:"quad-in",easeOutQuad:"quad-out",easeInOutQuad:"quad-in-out",easeInCubic:"cubic-in",easeOutCubic:"cubic-out",easeInOutCubic:"cubic-in-out",easeInSine:"sin-in",easeOutSine:"sin-out",easeInOutSine:"sin-in-out",easeInExpo:"exp-in",easeOutExpo:"exp-out",easeInOutExpo:"exp-in-out",easeInCirc:"circle-in",easeOutCirc:"circle-out",easeInOutCirc:"circle-in-out",easeInElastic:"elastic-out",easeOutElastic:"elastic-in",easeInOutElastic:"elastic-in-out",easeInBack:"back-in",easeOutBack:"back-out",easeInOutBack:"back-in-out",easeInBounce:"bounce-out",easeOutBounce:"bounce-in",easeInOutBounce:"bounce-in-out"},e.prototype.getEasingType=function(t){var e;if(e=this.easingTypes[t],null==e)throw new ReferenceError("'"+t+"' is not a easing type name");return e},e.prototype.mergeOptions=function(t,n){var r;return r=e.Util.extend({},t,n),r.animationEasing=this.getEasingType(r.animationEasing),r},e.prototype.validateData=function(t){if(!e.Util.is("Array",t)&&!e.Util.is("Object",t))throw new TypeError(""+t+" is not an array or object")},e}()}).call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};Chart.D3Chart=function(){"use strict";function e(e,n,r,i){this.selectors=e,this.data=n,this.options=r,this.updateScaleTextStyle=t(this.updateScaleTextStyle,this),this.updateScaleStrokeStyle=t(this.updateScaleStrokeStyle,this),this.updateGridTickStyle=t(this.updateGridTickStyle,this),this.renderYAxis=t(this.renderYAxis,this),this.renderXAxis=t(this.renderXAxis,this),this.renderGrid=t(this.renderGrid,this),this.renderYGrid=t(this.renderYGrid,this),this.renderXGrid=t(this.renderXGrid,this),this.getTransitionElement=t(this.getTransitionElement,this),this.getRootElementWidth=t(this.getRootElementWidth,this),this.getRootElementHeight=t(this.getRootElementHeight,this),this.getRootElement=t(this.getRootElement,this),this.attrTranslateToCenter=t(this.attrTranslateToCenter,this),i||(i={top:0,right:0,bottom:0,left:0}),this.defineRootElement(this.getRootElement(),this.getRootElementWidth(),this.getRootElementHeight(),i)}return e.xAxis=function(t,e){return null==e&&(e=10),d3.svg.axis().scale(t).ticks(e).tickSize(3,3).tickPadding(5).orient("bottom")},e.yAxis=function(t){return d3.svg.axis().scale(t).ticks(20).tickSize(3,0).tickPadding(7).orient("left")},e.prototype.attrTranslateToCenter=function(){var t,e;return e=this.getRootElementWidth()/2,t=this.getRootElementHeight()/2,"translate("+e+", "+t+")"},e.prototype.defineRootElement=function(t,e,n,r){return this.width=e-r.left-r.right,this.height=n-r.top-r.bottom,this.getRootElement().attr({width:this.width+r.left+r.right}).attr({height:this.height+r.top+r.bottom}).append("g").attr({transform:"translate("+r.left+","+r.top+")"}).classed({"margin-convention-element":!0})},e.prototype.duration=function(t){return null==t&&(t=this.options),17.333*t.animationSteps},e.prototype.getRootElement=function(){return d3.select(this.selectors)},e.prototype.getRootElementHeight=function(){return+this.getRootElement().attr("height")},e.prototype.getRootElementWidth=function(){return+this.getRootElement().attr("width")},e.prototype.getTransitionElement=function(t,e){return this.getRootElement().transition().duration(t).ease(e.animationEasing)},e.prototype.renderXGrid=function(t,n){var r;return r=t.rangeBand()/2,this.getRootElement().select(".margin-convention-element").append("g").classed({"grid-group":!0,"grid-x-group":!0}).call(e.xAxis(t).tickFormat("")).selectAll(".tick line").attr({x1:r,x2:r,y2:n})},e.prototype.renderYGrid=function(t,n){return this.getRootElement().select(".margin-convention-element").append("g").classed({"grid-group":!0,"grid-y-group":!0}).call(e.yAxis(t).tickFormat("")).selectAll(".tick line").attr({x1:0,x2:n})},e.prototype.renderGrid=function(){return this.getRootElement().selectAll(".grid-group").selectAll(".domain, text").data([]).exit().remove()},e.prototype.renderXAxis=function(t,n){return this.getRootElement().select(".margin-convention-element").append("g").classed({"scale-group":!0,"scale-x-group":!0}).attr("transform","translate(0,"+n+")").call(e.xAxis(t))},e.prototype.renderYAxis=function(t){return this.getRootElement().select(".margin-convention-element").append("g").classed({"scale-group":!0,"scale-y-group":!0}).call(e.yAxis(t)).select(".tick > text").remove()},e.prototype.updateGridTickStyle=function(t){return this.getRootElement().selectAll(".grid-group .tick line").attr({stroke:t.scaleGridLineColor})},e.prototype.updateScaleStrokeStyle=function(t){return this.getRootElement().selectAll(".scale-group").selectAll(".domain, .tick line").attr({fill:"none"}).attr({stroke:t.scaleLineColor}).attr({"stroke-width":t.scaleLineWidth})},e.prototype.updateScaleTextStyle=function(t){return this.getRootElement().selectAll(".scale-group text").attr({"font-family":t.scaleFontFamily}).attr({"font-size":t.scaleFontSize}).attr({"font-style":t.scaleFontStyle}).attr({fill:t.scaleFontColor})},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function r(){this.constructor=t}for(var i in n)e.call(n,i)&&(t[i]=n[i]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t};Chart.D3Pie=function(e){"use strict";function r(e,n,i){this.transitionEndAll=t(this.transitionEndAll,this),r.__super__.constructor.call(this,e,n,i)}return n(r,e),r.prototype.animateRotate=function(t,e,n){return n.animation&&n.animateRotate?t.transition().call(this.transitionEndAll,n).duration(this.duration()).ease(n.animationEasing).attrTween("d",function(t){var n;return n=d3.interpolate({startAngle:0,endAngle:0},t),function(t){return e(n(t))}}):void 0},r.prototype.animateScale=function(t){return t.animation&&t.animateScale?this.getRootElement().selectAll("g").attr({transform:""+this.attrTranslateToCenter()+" scale(0)"}).transition().call(this.transitionEndAll,t).duration(this.duration()).ease(t.animationEasing).attr({transform:"scale(1)"}):void 0},r.prototype.attrSegmentStroke=function(t){return t.segmentShowStroke?{stroke:t.segmentStrokeColor,"stroke-width":t.segmentStrokeWidth}:{stroke:"none","stroke-width":0}},r.prototype.drawChart=function(t,e){var n,r;return r=d3.layout.pie().value(function(t){return t.value}).sort(null),n=this.data.map(function(t){return t.color}),this.getRootElement().append("g").selectAll("path").data(r(this.data)).enter().append("path").attr(this.attrSegmentStroke(e)).attr({d:t,transform:this.attrTranslateToCenter(),fill:function(t,e){return n[e]}})},r.prototype.getOuterRadius=function(t,e,n){return~~(Math.min(t,e)/2-n)},r.prototype.getInnerRadius=function(){return 0},r.prototype.render=function(){var t,e,n,r,i,a,o;return o=this.getRootElementWidth(),e=this.getRootElementHeight(),r=5,i=this.getOuterRadius(o,e,r),n=this.getInnerRadius(i,this.options),t=d3.svg.arc().innerRadius(n).outerRadius(i),a=this.drawChart(t,this.options),this.transitionEndAllCount=this.setAnimationComplete(this.options),isNaN(this.transitionEndAllCount)&&this.options.onAnimationComplete.call(this),this.animateRotate(a,t,this.options),this.animateScale(this.options),this},r.prototype.setAnimationComplete=function(t){return"function"!=typeof t.onAnimationComplete?1/0:t.animation&&t.animateRotate&&t.animateScale?2:t.animation&&(t.animateRotate||t.animateScale)?1:0/0},r.prototype.transitionEndAll=function(t,e){var n;return n=0,t.each(function(){return++n}).each("end",function(t){return function(){return--n||0!==--t.transitionEndAllCount?void 0:e.onAnimationComplete.apply(t,arguments)}}(this))},r}(Chart.D3Chart)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function r(){this.constructor=t}for(var i in n)e.call(n,i)&&(t[i]=n[i]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t};Chart.D3Bar=function(e){"use strict";function r(e,n,i){this.transitBarBorder=t(this.transitBarBorder,this),this.transitBar=t(this.transitBar,this),this.renderBarBorder=t(this.renderBarBorder,this),this.renderBar=t(this.renderBar,this),this.renderBars=t(this.renderBars,this),this.render=t(this.render,this);var a;a={top:13,right:23,bottom:24,left:55},r.__super__.constructor.call(this,e,n,i,a)}return n(r,e),r.adjustRangeBand=function(t){return t-1},r.rectBorderPath=function(t,e,n,i,a,o){var s,l,u,c,h,d;return s=n,u=o.barStrokeWidth/2,h=i(e),c=r.adjustRangeBand(i.rangeBand()),d=a(t.value)+u,l=[{x:h+u,y:s},{x:h+u,y:d},{x:h+c-u,y:d},{x:h+c-u,y:s}],d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y})(l)},r.xScale=function(t,e){return d3.scale.ordinal().domain(t).rangeRoundBands([0,e],0,0)},r.yScale=function(t,e,n){var r;return null==n&&(n=0),r=d3.max(t,function(t){return d3.max(t.values,function(t){return t.value})}),d3.scale.linear().domain([0,r]).range([e,n]).nice()},r.prototype.generateData=function(t,e){var n;return null==t||null==e?null:(n=[],e.forEach(function(e){return e.data.map(function(r,i){return n.push({value:r,label:t[i],fillColor:e.fillColor,strokeColor:e.strokeColor})})}),d3.nest().key(function(t){return t.label}).entries(n))},r.prototype.render=function(){var t,e,n,i,a,o,s,l,u,c,h,d;return o=this.data.labels,i=this.data.datasets,n=this.generateData(o,i),null==n&&null==(null!=n?n.length:void 0)?this:(s=this.options,e=this.width,t=this.height,l=r.xScale(o,e),h=d3.range(i.length),d=l.rangeBand()-2*s.barValueSpacing,u=r.xScale(h,d),c=r.yScale(n,t),this.renderXGrid(l,t),this.renderYGrid(c,e),this.renderGrid(),this.renderXAxis(l,t),this.renderYAxis(c),this.renderBars(n,l,s),this.renderBar(t,u,c,s),this.renderBarBorder(t,u,c,s),this.updateGridTickStyle(s),this.updateScaleStrokeStyle(s),this.updateScaleTextStyle(s),a=this.getTransitionElement(this.duration(),s),this.transitBar(a,t,c),this.transitBarBorder(a,t),this)},r.prototype.renderBars=function(t,e,n){return this.getRootElement().select(".margin-convention-element").append("g").classed("bar-chart",!0).selectAll(".bars-group").data(t).enter().append("g").classed("bars-group",!0).attr("transform",function(t){return"translate("+(e(t.key)+n.barValueSpacing)+",0)"})},r.prototype.renderBar=function(t,e,n){return this.getRootElement().selectAll(".bars-group").selectAll("rect").data(function(t){return t.values}).enter().append("g").classed("bar-group",!0).append("rect").classed("bar",!0).attr("x",function(t,n){return e(n)}).attr("width",r.adjustRangeBand(e.rangeBand())).attr("y",function(t){return n(t.value)}).attr("height",function(e){return t-n(e.value)}).attr("fill",function(t){return t.fillColor})},r.prototype.renderBarBorder=function(t,e,n,i){return this.getRootElement().selectAll(".bars-group").selectAll(".bar-group").append("path").classed("bar-border",!0).attr("d",function(a,o){return r.rectBorderPath(a,o,t,e,n,i)}).attr("fill","none").attr("stroke",function(t){return t.strokeColor}).attr("stroke-width",i.barStrokeWidth)},r.prototype.transitBar=function(t,e,n){return this.getRootElement().selectAll(".bar").attr("y",e).attr("height",0),t.selectAll(".bar").attr("y",function(t){return n(t.value)}).attr("height",function(t){return e-n(t.value)})},r.prototype.transitBarBorder=function(t,e){return this.getRootElement().selectAll(".bar-border").attr("transform","translate(0,"+e+") scale(1,0)"),t.selectAll(".bar-border").attr("transform","translate(0,0) scale(1,1)")},r}(Chart.D3Chart)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function r(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e};Chart.D3Doughnut=function(t){"use strict";function n(t,e,r){n.__super__.constructor.call(this,t,e,r)}return e(n,t),n.prototype.getInnerRadius=function(t,e){return~~(t*(e.percentageInnerCutout/100))},n}(Chart.D3Pie)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function r(){this.constructor=t}for(var i in n)e.call(n,i)&&(t[i]=n[i]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t};Chart.D3Line=function(e){"use strict";function r(e,n,i){this.transitLines=t(this.transitLines,this),this.transitDots=t(this.transitDots,this),this.transitAreas=t(this.transitAreas,this),this.renderLines=t(this.renderLines,this),this.renderDots=t(this.renderDots,this),this.renderAreas=t(this.renderAreas,this),this.renderLinesGroup=t(this.renderLinesGroup,this),this.render=t(this.render,this);var a;a={top:13,right:23,bottom:24,left:55},r.__super__.constructor.call(this,e,n,i,a)}return n(r,e),r.area=function(t,e,n,r,i){var a;return a=r.bezierCurve?"linear":"linear",d3.svg.area().x(function(e,r){return t(n[r])}).y0(i).y1(function(t){return e(t)}).interpolate(a)},r.line=function(t,e,n,r){var i;return i=r.bezierCurve?"linear":"linear",d3.svg.line().x(function(e,r){return t(n[r])}).y(function(t){return e(t)}).interpolate(i)},r.xScale=function(t,e){return d3.scale.ordinal().domain(t).rangePoints([0,e],0,0)},r.yScale=function(t,e,n){var r;return null==n&&(n=0),r=d3.max(t,function(t){return d3.max(t.data)}),d3.scale.linear().domain([0,r]).range([e,n]).nice()},r.prototype.render=function(){var t,e,n,i,a,o,s,l,u,c,h;return o=this.data.labels,i=this.data.datasets,null==i&&null==(null!=i?i.length:void 0)?this:(l=this.options,u=this.options.barStrokeWidth,n=this.width,e=this.height,c=r.xScale(o,n),h=r.yScale(i,e),this.renderXGrid(c,e),this.renderYGrid(h,n),this.renderGrid(),this.renderXAxis(c,e),this.renderYAxis(h),this.renderLinesGroup(i),t=r.area(c,h,o,l,e),this.renderAreas(t,i,l),s=r.line(c,h,o,l),this.renderLines(s,i,l),this.renderDots(i,o,c,h,l),this.updateGridTickStyle(l),this.updateScaleStrokeStyle(l),this.updateScaleTextStyle(l),a=this.getTransitionElement(this.duration(),l),this.transitAreas(a,e),this.transitLines(a,e),this.transitDots(a,e,h),this)},r.prototype.renderLinesGroup=function(t){return this.getRootElement().select(".margin-convention-element").append("g").classed("line-chart",!0).append("g").classed("lines-group",!0).selectAll("g").data(t).enter().append("g").classed("line-group",!0)},r.prototype.renderAreas=function(t,e,n){return n.datasetFill?this.getRootElement().selectAll(".line-group").data(e).append("path").classed("area",!0).attr("d",function(e){return t(e.data)}).attr("stroke","none").attr("fill",function(t){return t.fillColor}):null},r.prototype.renderDots=function(t,e,n,r,i){var a;return i.pointDot?(a=t.map(function(t){return t.data.map(function(e){return{value:e,fillColor:t.fillColor,strokeColor:t.strokeColor,pointColor:t.pointColor,pointStrokeColor:t.pointStrokeColor}})}),this.getRootElement().selectAll(".line-group").data(a).selectAll(".dot").data(function(t){return t}).enter().append("circle").classed({dot:!0}).attr({r:i.pointDotRadius}).attr("cx",function(t,r){return n(e[r])}).attr("cy",function(t){return r(t.value)}).attr("stroke",function(t){return t.pointStrokeColor}).attr("stroke-width",i.pointDotStrokeWidth).attr("fill",function(t){return t.pointColor})):null},r.prototype.renderLines=function(t,e,n){return this.getRootElement().selectAll(".line-group").data(e).append("path").classed("line",!0).attr("d",function(e){return t(e.data)}).attr("stroke",function(t){return t.strokeColor}).attr("stroke-width",n.datasetStrokeWidth).attr("fill","none")},r.prototype.transitAreas=function(t,e){return this.getRootElement().selectAll(".area").attr("transform","translate(0,"+e+") scale(1,0)"),t.selectAll(".area").attr("transform","translate(0,0) scale(1,1)")},r.prototype.transitDots=function(t,e,n){return this.getRootElement().selectAll(".dot").attr("cy",e),t.selectAll(".dot").attr("cy",function(t){return n(t.value)})},r.prototype.transitLines=function(t,e){return this.getRootElement().selectAll(".line").attr("transform","translate(0,"+e+") scale(1,0)"),t.selectAll(".line").attr("transform","translate(0,0) scale(1,1)")},r}(Chart.D3Chart)}.call(this);